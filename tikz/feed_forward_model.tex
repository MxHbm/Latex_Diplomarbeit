\begin{figure}[ht]
    \centering
    \begin{tikzpicture}[
            >=Latex,
            neuron/.style={circle, draw, minimum size=16pt, inner sep=0pt},
            input/.style={neuron, fill=blue!8},
            hidden/.style={neuron, fill=green!8},
            output/.style={draw, rounded corners=3pt, minimum width=24pt, minimum height=16pt, inner sep=2pt, fill=red!8},
            dotnode/.style={draw=none, fill=none, minimum size=6pt, inner sep=0pt},
            conn/.style={-Latex, thick},
            hiddenneuron/.style={circle, minimum size=16pt, inner sep=0pt},
        ]

        % Column x-positions
        \def\xin{0}
        \def\xhA{2.6}
        \def\xhB{5.2}
        \def\xout{7.8}
        \def\xcls{10.2}

        % ------- Inputs (show only x1, x2, ... , xn) -------
        \node[input] (x1)  at (\xin,  -1.2) {$x_1$};
        \node[input] (x2)  at (\xin,  -2.2) {$x_2$};
        \node[dotnode] (dots) at (\xin, -3.0) {$\vdots$};
        \node[input] (xn)  at (\xin,  -3.8) {$x_n$};

        %\node[above=6pt of x1] (inlab) {\small Inputs (features)};

        % ------- Hidden layer 1 (3 neurons) -------
        \node[hidden] (h1) at (\xhA, -1.2) {};
        \node[hidden] (h2) at (\xhA, -2.5) {};
        \node[hidden] (h3) at (\xhA, -3.8) {};
        %\node[above=6pt of h1] {\small Hidden layer 1};

        % ------- Hidden layer 2 (3 neurons) -------
        \node[hidden] (g1) at (\xhB, -1.2) {};
        \node[hidden] (g2) at (\xhB, -2.5) {};
        \node[hidden] (g3) at (\xhB, -3.8) {};
        %\node[above=6pt of g1] {\small Hidden layer 2};

        % ------- Output (sigmoid) -------
        \node[output, label=:{Sigmoid}] (y) at (\xout, -2.5) {$\hat{y}=s(z)$};
        \node[hiddenneuron] (_y) at (\xout - 0.55, -2.5) {};
        %\node[above=6pt of y] {\small Sigmoid output};

        % ------- Class labels (annotation) -------
        \node[output] (th) at (\xcls, -2.5) {\small thresh $0.5$};
        \node[neuron, minimum size=14pt] (y1) at (\xcls + 1.8, -1.6) {\small 1};
        \node[neuron, minimum size=14pt] (y0) at (\xcls + 1.8, -3.4) {\small 0};
        %\node[right=4pt of y1] {\small class if $\hat p>0.5$};
        %\node[right=4pt of y0] {\small else};

        % ------- Connections -------
        % Inputs -> Hidden1 (skip the dots node)
        \foreach \src in {x1,x2,xn} {
                \foreach \dst in {h1,h2,h3} {
                        \draw[conn] (\src) -- (\dst);
                    }
            }

        % Hidden1 -> Hidden2
        \foreach \src in {h1,h2,h3} {
                \foreach \dst in {g1,g2,g3} {
                        \draw[conn] (\src) -- (\dst);
                    }
            }

        % Hidden2 -> Output
        \foreach \src in {g1,g2,g3} {
                \draw[conn,shorten >=3pt] (\src) -- (_y);
            }

        % Output -> threshold -> class nodes (annotation)
        \draw[conn] (y) -- (th);
        \draw[conn] (th.north east) to[out=60,in=180] (y1.west);
        \draw[conn] (th.south east) to[out=-60,in=180] (y0.west);

    \end{tikzpicture}
    \caption[An exemplary feed forward neural network with sigmoid output function.]{An exemplary feed forward neural network with sigmoid output function. Blue nodes are input, green ones hidden and red nodes output nodes.}
    \label{fig:ffnn}
\end{figure}